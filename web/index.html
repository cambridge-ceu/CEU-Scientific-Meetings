<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>SRCF website - CEU scientific meetings</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet"/>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script defer="" src="../js/jquery-1.10.2.min.js"></script>
<script defer="" src="../js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/HTML.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/JavaScript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Perl.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
<div class="container">
<a class="navbar-brand" href="..">CEU scientific meetings</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href=".."></a>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Chronicle <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../2024/">2024</a>
</li>
<li>
<a class="dropdown-item" href="../2023/">2023</a>
</li>
<li>
<a class="dropdown-item" href="../2022/">2022</a>
</li>
<li>
<a class="dropdown-item" href="../2021/">2021</a>
</li>
<li>
<a class="dropdown-item" href="../2020/">2020</a>
</li>
<li>
<a class="dropdown-item" href="../mhs/">Mental health support</a>
</li>
<li>
<a class="dropdown-item" href="../COVID-19/">The COVID-19 pandemic</a>
</li>
<li>
<a class="dropdown-item" href="../Cambridge-Baker-Joint-Symposium/">The Cambridge/Baker Joint Symposium</a>
</li>
</ul>
</li>
<li class="navitem">
<a class="nav-link" href="../HDR/">HDR(UK)</a>
</li>
<li class="navitem">
<a class="nav-link" href="../schedules/">Schedules</a>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Resources <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../CEU/">CEU</a>
</li>
<li>
<a class="dropdown-item" href="../DPHPC/">DPHPC</a>
</li>
<li>
<a class="dropdown-item" href="../School/">School</a>
</li>
<li>
<a class="dropdown-item" href="../University/">University</a>
</li>
</ul>
</li>
<li class="navitem">
<a class="nav-link" href="../channels/">Channels</a>
</li>
<li class="navitem">
<a class="nav-link" href="../talks/">Talks</a>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" data-target="#mkdocs_search_modal" data-toggle="modal" href="#">
<i class="fa fa-search"></i> Search
                            </a>
</li>
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
<li class="nav-item" data-level="1"><a class="nav-link" href="#srcf-website">SRCF website</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="2"><a class="nav-link" href="#htaccess">.htaccess</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#socket-via-c">Socket via C</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#socket-via-python">Socket via Python</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#raven-authentication">Raven authentication</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<h1 id="srcf-website">SRCF website</h1>
<blockquote>
<p>The SRCF uses Apache to serve websites so if you need to run a backend web app, for example a Django, Rails or Express server, then you will need to forward web requests.</p>
</blockquote>
<ul>
<li>Port binding, <a href="https://docs.srcf.net/reference/shell-and-files/software-and-installation/#port-binding">https://docs.srcf.net/reference/shell-and-files/software-and-installation/#port-binding</a></li>
<li>Website traffic, <a href="https://docs.srcf.net/reference/web-hosting/web-applications/#routing-traffic-to-your-app">https://docs.srcf.net/reference/web-hosting/web-applications/#routing-traffic-to-your-app</a></li>
</ul>
<p>e.g., CRSid.user.srcf.net through to an app running on a localhost port.</p>
<h2 id="htaccess">.htaccess</h2>
<p>It sits on the current directory.</p>
<pre><code>RequestHeader set Host expr=%{HTTP_HOST}
RequestHeader set X-Forwarded-For expr=%{REMOTE_ADDR}
RequestHeader set X-Forwarded-Proto expr=%{REQUEST_SCHEME}
RequestHeader set X-Real-IP expr=%{REMOTE_ADDR}
RewriteRule ^(.*)$ unix:&lt;path-to-socket&gt;|http://&lt;url&gt;/$1 [P,NE,L,QSA]
</code></pre>
<p>Based on chatGPT,</p>
<ul>
<li>RequestHeader set Host expr=%{HTTP_HOST}: Sets the Host header to the value of the HTTP_HOST variable.</li>
<li>RequestHeader set X-Forwarded-For expr=%{REMOTE_ADDR}: Sets the X-Forwarded-For header to the value of the REMOTE_ADDR variable.</li>
<li>RequestHeader set X-Forwarded-Proto expr=%{REQUEST_SCHEME}: Sets the X-Forwarded-Proto header to the value of the REQUEST_SCHEME variable.</li>
<li>RequestHeader set X-Real-IP expr=%{REMOTE_ADDR}: Sets the X-Real-IP header to the value of the REMOTE_ADDR variable.</li>
<li>RewriteRule ^(.*)$ unix:<path-to-socket>|http://&lt;url&gt;/$1 [P,NE,L,QSA]: The RewriteRule is rewriting the URL. It proxies requests to a specified URL with a Unix domain socket. Replace <path-to-socket> with the actual path to your Unix domain socket and <url> with the target URL.</url></path-to-socket></path-to-socket></li>
<li>[P,NE,L,QSA]: These are flags that modify the behavior of the RewriteRule:<ul>
<li>P: Proxy flag. This tells Apache to treat the substitution as a proxy request and forward it to the specified location.</li>
<li>NE: No Escape flag. This prevents Apache from escaping special characters in the substitution, useful when substituting URLs.</li>
<li>L: Last flag. This indicates that if the current rule matches, no further rules should be processed for this request.</li>
<li>QSA: Query String Append flag. This appends the original query string to the substituted URL.</li>
</ul>
</li>
</ul>
<p>Make sure to replace <path-to-socket> and <url> with your actual values. Additionally, ensure that the necessary modules (mod_headers and mod_rewrite) are enabled in your Apache configuration.</url></path-to-socket></p>
<h3 id="examples">Examples</h3>
<ul>
<li>Unix</li>
<li>RewriteRule ^(.*)$ unix:/home/jhz22/web.sock|http://localhost/$1 [P,NE,L,QSA]</li>
<li>RewriteRule ^(.*)$ unix:/home/jhz22/web.sock|http://jhz22.user.srcf.net/$1 [P,NE,L,QSA]</li>
<li>TCP -- no headers</li>
<li>RewriteRule "^(.*)$" http://localhost:8012/$1 [P,NE,L,QSA]</li>
</ul>
<h2 id="socket-via-c">Socket via C</h2>
<p>Source: <a href="https://gist.githubusercontent.com/ryran/170009f84c11bf3243b1/raw/699ac4d60c74d33fa7b56c734cb0ba6f3c0163f0/create-a-socket.c">https://gist.githubusercontent.com/ryran/170009f84c11bf3243b1/raw/699ac4d60c74d33fa7b56c734cb0ba6f3c0163f0/create-a-socket.c</a></p>
<pre><code class="language-c">#include &lt;fcntl.h&gt;
#include &lt;sys/un.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;

int main(int argc, char **argv)
{
    // The following line expects the socket path to be first argument
    char * mysocketpath = argv[1];
    // Alternatively, you could comment that and set it statically:
    //char * mysocketpath = "/tmp/mysock";
    struct sockaddr_un namesock;
    int fd;
    namesock.sun_family = AF_UNIX;
    strncpy(namesock.sun_path, (char *)mysocketpath, sizeof(namesock.sun_path));
    fd = socket(AF_UNIX, SOCK_DGRAM, 0);
    bind(fd, (struct sockaddr *) &amp;namesock, sizeof(struct sockaddr_un));
    close(fd);
    return 0;
}
</code></pre>
<p>and compiled with <code>gcc cleate-a-socket.c -o create-a-socket; create-a-socket web.sock</code>.</p>
<h2 id="socket-via-python">Socket via Python</h2>
<p>Source: <a href="https://www.digitalocean.com/community/tutorials/python-socket-programming-server-client">https://www.digitalocean.com/community/tutorials/python-socket-programming-server-client</a></p>
<p>We employ <code>python server.py</code> and <code>python client.py</code> below for two interactive sessions which ends with <code>bye</code>.</p>
<h3 id="serverpy">server.py</h3>
<pre><code class="language-python">import socket

def server_program():
    # get the hostname
    host = socket.gethostname()
    port = 5000  # initiate port no above 1024

    server_socket = socket.socket()  # get instance
    # look closely. The bind() function takes tuple as argument
    server_socket.bind((host, port))  # bind host address and port together

    # configure how many client the server can listen simultaneously
    server_socket.listen(2)
    conn, address = server_socket.accept()  # accept new connection
    print("Connection from: " + str(address))
    while True:
        # receive data stream. it won't accept data packet greater than 1024 bytes
        data = conn.recv(1024).decode()
        if not data:
            # if data is not received break
            break
        print("from connected user: " + str(data))
        data = input(' -&gt; ')
        conn.send(data.encode())  # send data to the client

    conn.close()  # close the connection

if __name__ == '__main__':
    server_program()
</code></pre>
<h3 id="clientpy">client.py</h3>
<pre><code class="language-python">import socket

def client_program():
    host = socket.gethostname()  # as both code is running on same pc
    port = 5000  # socket server port number

    client_socket = socket.socket()  # instantiate
    client_socket.connect((host, port))  # connect to the server

    message = input(" -&gt; ")  # take input

    while message.lower().strip() != 'bye':
        client_socket.send(message.encode())  # send message
        data = client_socket.recv(1024).decode()  # receive response

        print('Received from server: ' + data)  # show in terminal

        message = input(" -&gt; ")  # again take input

    client_socket.close()  # close the connection

if __name__ == '__main__':
    client_program()
</code></pre>
<h2 id="raven-authentication">Raven authentication</h2>
<p>Web: <a href="https://docs.srcf.net/reference/web-hosting/raven-authentication/">https://docs.srcf.net/reference/web-hosting/raven-authentication/</a></p></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script defer="" src="../js/base.js"></script>
<script defer="" src="../javascripts/config.js"></script>
<script defer="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script defer="" src="../search/main.js"></script>
<div aria-hidden="true" aria-labelledby="searchModalLabel" class="modal" id="mkdocs_search_modal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="searchModalLabel">Search</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
<form>
<div class="form-group">
<input class="form-control" id="mkdocs-search-query" placeholder="Search..." title="Type search term here" type="search"/>
</div>
</form>
<div id="mkdocs-search-results"></div>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div><div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
</body>
</html>
